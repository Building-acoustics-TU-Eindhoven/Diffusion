

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Diffusion Equation Finite Volume Method (FVM) Documentation &mdash; Diffusion Equation for Acoustics 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=2709fde1"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Auralization Documentation" href="DocumentationAuralization.html" />
    <link rel="prev" title="Diffusion Equation Finite Different Method (FDM) documentation" href="DocumentationFDM.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Diffusion Equation for Acoustics
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Software Presentation:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Overview.html">Overview</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Software Use:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Finite%20Different%20Method%20Use.html">Finite Different Method Use</a></li>
<li class="toctree-l1"><a class="reference internal" href="Finite%20Volume%20Method%20Use.html">Finite Volume Method Use</a></li>
<li class="toctree-l1"><a class="reference internal" href="Auralization%20Use.html">Auralization Use</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Software Theory:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="DocumentationFDM.html">Diffusion Equation Finite Different Method (FDM) documentation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Diffusion Equation Finite Volume Method (FVM) Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#theory-of-diffusion-equation-model">Theory of Diffusion Equation model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#finite-volume-scheme">Finite Volume Scheme</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#diffusion-equation">Diffusion Equation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#boundary-conditions">Boundary Conditions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#discretization">Discretization</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="DocumentationAuralization.html">Auralization Documentation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API reference:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="acousticDE/FDMfunctions.html">FDM functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="acousticDE/FVMfunctions.html">FVM functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="acousticDE/ReverberationFunctions.html">Reverberation functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="acousticDE/Auralizationfunctions.html">Auralization functions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Finite%20Different%20Method%20Demo%20Tutorial.html">Finite Different Method Demo Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="Finite%20Volume%20Method%20Demo%20Tutorial.html">Finite Volume Method Demo Tutorial</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Diffusion Equation for Acoustics</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Diffusion Equation Finite Volume Method (FVM) Documentation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/DocumentationFVM.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="diffusion-equation-finite-volume-method-fvm-documentation">
<h1>Diffusion Equation Finite Volume Method (FVM) Documentation<a class="headerlink" href="#diffusion-equation-finite-volume-method-fvm-documentation" title="Link to this heading"></a></h1>
<p>The software is based on the Finite Volume method (FVM) solving the diffusion equation (Munoz, 2019).</p>
<section id="theory-of-diffusion-equation-model">
<h2>Theory of Diffusion Equation model<a class="headerlink" href="#theory-of-diffusion-equation-model" title="Link to this heading"></a></h2>
<p>The model for the sound energy density <span class="math notranslate nohighlight">\(w(\mathbf{r}, t)\)</span> at position <span class="math notranslate nohighlight">\(\mathbf{r} = [x,y,z]\)</span> and at time <span class="math notranslate nohighlight">\(t\)</span> on a domain <span class="math notranslate nohighlight">\(V\)</span> is based on the following partial differential equation:</p>
<div class="math notranslate nohighlight">
\[\frac{\partial w(\mathbf{r}, t)}{\partial t}
- D \left( \frac{\partial^2 w(\mathbf{r}, t)}{\partial x^2}
+ \frac{\partial^2 w(\mathbf{r}, t)}{\partial y^2}
+ \frac{\partial^2 w(\mathbf{r}, t)}{\partial z^2} \right)
+ c m w(\mathbf{r}, t) = P(t)\delta(\mathbf{r} - \mathbf{r}_s)\]</div>
<p>where <span class="math notranslate nohighlight">\(\frac{\partial^2}{\partial x^2}\)</span>, <span class="math notranslate nohighlight">\(\frac{\partial^2}{\partial y^2}\)</span>, <span class="math notranslate nohighlight">\(\frac{\partial^2}{\partial z^2}\)</span> are the Laplace operators and <span class="math notranslate nohighlight">\(D = \frac{\lambda c}{3}\)</span> is the so-called theoretical diffusion coefficient with <span class="math notranslate nohighlight">\(c\)</span> being the speed of sound. The diffusion coefficient is a constant value that takes into account the room geometry and volume trough the mean free path defined for proportionate rooms as <span class="math notranslate nohighlight">\(\lambda = \frac{4 V}{S}\)</span> with volume <span class="math notranslate nohighlight">\(V\)</span> of the room and <span class="math notranslate nohighlight">\(S\)</span> the total surface area. The term <span class="math notranslate nohighlight">\(P(t)\)</span> indicates a sound source term at position <span class="math notranslate nohighlight">\(r_s\)</span>. The term <span class="math notranslate nohighlight">\(c m w(\mathbf{r}, t)\)</span> accounts for the atmospheric attenuation within the room, where <span class="math notranslate nohighlight">\(m\)</span> is the absorption coefficient of air (Billon et al., 2008).</p>
<p>The main partial differential equation is associated with mixed boundary conditions on a domain <span class="math notranslate nohighlight">\(\partial V\)</span>, as follows:</p>
<div class="math notranslate nohighlight">
\[-D \frac{\partial w(\mathbf{r}, t)} {\partial n} = A_{r}(\mathbf{r},\alpha ) c w(\mathbf{r}, t) \text{ on } \partial V\]</div>
<p>This models the effect of the absorption at the surfaces in the sound field.
The term <span class="math notranslate nohighlight">\(n\)</span> indicates the vector normal to the surface and the term <span class="math notranslate nohighlight">\(A_{r}\)</span> is dependent on the absorption coefficient <span class="math notranslate nohighlight">\(\alpha\)</span>. Depending on the scope and on the absorption coefficient to use, the absorption term <span class="math notranslate nohighlight">\(A_{r}\)</span> is defined differently. There are three different absorption factors <span class="math notranslate nohighlight">\(A_{r}\)</span>: the Sabine (Picaut at al., 1999; Valeau at al., 2006), the Eyring (Jing et al., 2007; Billon et al., 2008) and the modified by Xiang (Jing et al., 2008).</p>
</section>
<section id="finite-volume-scheme">
<h2>Finite Volume Scheme<a class="headerlink" href="#finite-volume-scheme" title="Link to this heading"></a></h2>
<section id="diffusion-equation">
<h3>Diffusion Equation<a class="headerlink" href="#diffusion-equation" title="Link to this heading"></a></h3>
<p>The software is implemented using the numerical Finite Volume Method to solve the partial differential diffusion equation in the form of algebraic equations (Munoz, 2019).
The Finite Volume method is based on the discretization of the room in discrete nodes surrounded by finite volumes within the volume domain.</p>
<p>As for the finite element method, the finite volume method consists on the creation of a mesh of the room. The mesh elements are called control volumes. The solution is obtained from the fluxes of energy from one volume element to the other, at each time step, until the total recording time. The results from the diffusion equation and boundary condition are calculated in the centre of each control volume.</p>
<p>For the discretization, the following are important:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(j\)</span> control volume;</p></li>
<li><p><span class="math notranslate nohighlight">\(k\)</span> control volume adjacent to <span class="math notranslate nohighlight">\(j\)</span>;</p></li>
<li><p><span class="math notranslate nohighlight">\(w_j\)</span> energy density computed at the centre of control volume <span class="math notranslate nohighlight">\(j\)</span>;</p></li>
<li><p><span class="math notranslate nohighlight">\(w_k\)</span> energy density computed at the centre of control volume <span class="math notranslate nohighlight">\(k\)</span>;</p></li>
<li><p><span class="math notranslate nohighlight">\(S_{j,k}\)</span> common area between control volume <span class="math notranslate nohighlight">\(j\)</span> and control volume <span class="math notranslate nohighlight">\(k\)</span>;</p></li>
<li><p><span class="math notranslate nohighlight">\(d_{j,k}\)</span> distance between centre of control volume <span class="math notranslate nohighlight">\(j\)</span> and centre of control volume <span class="math notranslate nohighlight">\(k\)</span>.</p></li>
</ul>
<p>The diffusion equation need to be integrated over one element <span class="math notranslate nohighlight">\(j\)</span> via the following equation:</p>
<div class="math notranslate nohighlight">
\[\frac{\partial}{\partial t} \int_{\Omega_j}  w(\mathbf{r}, t) dr - D \int_{\partial Omega} \nabla  w(\mathbf{r}, t) n dr = \int_{\Omega_j} P(t) delta(r-r_s )\]</div>
</section>
<section id="boundary-conditions">
<h3>Boundary Conditions<a class="headerlink" href="#boundary-conditions" title="Link to this heading"></a></h3>
<p>Additional equations are needed to describe the sound field at the boundaries.
The boundary condition above can be discretised for every face of a control volume being part of the boundary of the domain.</p>
<div class="math notranslate nohighlight">
\[- D \frac{\partial}{\partial n}  w_j(\mathbf{r}, t) = - h_{(b)j,k}  w_j\]</div>
<p>The term <span class="math notranslate nohighlight">\(n\)</span> indicates the vector normal to the surface and the term <span class="math notranslate nohighlight">\(h_{(b)j,k}\)</span> is dependent on the absorption coefficient <span class="math notranslate nohighlight">\(\alpha\)</span> of the surface are of the <span class="math notranslate nohighlight">\(j\)</span> control volume.</p>
</section>
<section id="discretization">
<h3>Discretization<a class="headerlink" href="#discretization" title="Link to this heading"></a></h3>
<p>The full discretised partial differential diffusion equation is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\frac{V_j (w_{j}^{n+1} - w_{j}^{n-1})}{2 \Delta t} - D \sum_{k=1}^{N_f} \frac{S_{i,k}}{h_{j,k}} \Big(w_{k}^{n} - \frac{w_{j}^{n+1} - w_{j}^{n-1}}{2}\Big) \\
- \sum_{k=1}^{N_{bf}} S_{i,k}  h_{(b)j,k} \Big(\frac{w_{j}^{n+1} - w_{j}^{n-1}}{2} \Big) = V_j P_{j}^{n}\end{split}\]</div>
<!-- 

```{math}
\frac{V_j (w_{j}^{n+1} - w_{j}^{n-1})}{2 \Delta t} - D \sum_{k=1}^{N_f} \frac{S_{i,k}}{h_{j,k}} \Big(w_{k}^{n} - \frac{w_{j}^{n+1} - w_{j}^{n-1}}{2}\Big) - \sum_{k=1}^{N_{bf}} S_{i,k}  h_{(b)j,k} \Big(\frac{w_{j}^{n+1} - w_{j}^{n-1}}{2} \Big) = V_j P_{j}^{n}
``` -->
</section>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>R. P. MuÃ±oz, Numerical modeling for urban sound propagation: developments in wave-based and energy based methods, PhD Thesis, Technische Universiteit Eindhoven, 2019.</p></li>
<li><p>M. VorlÃ¤nder, Auralization: fundamentals of acoustics, modelling, simulation, algorithms and acoustic virtual reality,  Springer 2008.</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="DocumentationFDM.html" class="btn btn-neutral float-left" title="Diffusion Equation Finite Different Method (FDM) documentation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="DocumentationAuralization.html" class="btn btn-neutral float-right" title="Auralization Documentation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Ilaria Fichera.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>